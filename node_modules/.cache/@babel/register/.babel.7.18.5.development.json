{"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _routes = _interopRequireDefault(require(\"./routes\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst dotenv = require(\"dotenv\");\n\ndotenv.config();\n\nrequire('./database.js');\n\nvar app = (0, _express.default)();\n\nconst router = _express.default.Router();\n\napp.use(_express.default.json()); // Used to parse JSON bodies\n\napp.use(_express.default.urlencoded()); //Parse URL-encoded bodies\n\napp.set('view engine', 'ejs');\napp.use(_express.default.static(__dirname + '/../public')); //import routes\n\napp.use(_routes.default);\nvar port = process.env.PORT_SERVER || 9000;\napp.listen(port, function () {\n  console.log(\"Server Has Started! port: \", port);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkb3RlbnYiLCJyZXF1aXJlIiwiY29uZmlnIiwiYXBwIiwiZXhwcmVzcyIsInJvdXRlciIsIlJvdXRlciIsInVzZSIsImpzb24iLCJ1cmxlbmNvZGVkIiwic2V0Iiwic3RhdGljIiwiX19kaXJuYW1lIiwiRGVmYXVsdFJvdXRlciIsInBvcnQiLCJwcm9jZXNzIiwiZW52IiwiUE9SVF9TRVJWRVIiLCJsaXN0ZW4iLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvIiwic291cmNlcyI6WyJhcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIjtcbmNvbnN0IGRvdGVudiA9IHJlcXVpcmUoXCJkb3RlbnZcIik7XG5pbXBvcnQgRGVmYXVsdFJvdXRlciBmcm9tICcuL3JvdXRlcyc7XG5cblxuZG90ZW52LmNvbmZpZygpO1xuXG5yZXF1aXJlKCcuL2RhdGFiYXNlLmpzJylcblxudmFyIGFwcCA9IGV4cHJlc3MoKTtcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5cbmFwcC51c2UoZXhwcmVzcy5qc29uKCkpOyAvLyBVc2VkIHRvIHBhcnNlIEpTT04gYm9kaWVzXG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCgpKTsgLy9QYXJzZSBVUkwtZW5jb2RlZCBib2RpZXNcblxuYXBwLnNldCgndmlldyBlbmdpbmUnLCAnZWpzJyk7XG5cbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMoX19kaXJuYW1lICsgJy8uLi9wdWJsaWMnKSk7XG4vL2ltcG9ydCByb3V0ZXNcbmFwcC51c2UoRGVmYXVsdFJvdXRlcik7XG5cbnZhciBwb3J0ID0gcHJvY2Vzcy5lbnYuUE9SVF9TRVJWRVIgfHwgOTAwMDtcblxuYXBwLmxpc3Rlbihwb3J0LCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc29sZS5sb2coXCJTZXJ2ZXIgSGFzIFN0YXJ0ZWQhIHBvcnQ6IFwiLCBwb3J0KTtcbn0pO1xuXG4iXSwibWFwcGluZ3MiOiI7O0FBQUE7O0FBRUE7Ozs7QUFEQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxRQUFELENBQXRCOztBQUlBRCxNQUFNLENBQUNFLE1BQVA7O0FBRUFELE9BQU8sQ0FBQyxlQUFELENBQVA7O0FBRUEsSUFBSUUsR0FBRyxHQUFHLElBQUFDLGdCQUFBLEdBQVY7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxnQkFBQSxDQUFRRSxNQUFSLEVBQWY7O0FBRUFILEdBQUcsQ0FBQ0ksR0FBSixDQUFRSCxnQkFBQSxDQUFRSSxJQUFSLEVBQVIsRSxDQUF5Qjs7QUFDekJMLEdBQUcsQ0FBQ0ksR0FBSixDQUFRSCxnQkFBQSxDQUFRSyxVQUFSLEVBQVIsRSxDQUErQjs7QUFFL0JOLEdBQUcsQ0FBQ08sR0FBSixDQUFRLGFBQVIsRUFBdUIsS0FBdkI7QUFFQVAsR0FBRyxDQUFDSSxHQUFKLENBQVFILGdCQUFBLENBQVFPLE1BQVIsQ0FBZUMsU0FBUyxHQUFHLFlBQTNCLENBQVIsRSxDQUNBOztBQUNBVCxHQUFHLENBQUNJLEdBQUosQ0FBUU0sZUFBUjtBQUVBLElBQUlDLElBQUksR0FBR0MsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFdBQVosSUFBMkIsSUFBdEM7QUFFQWQsR0FBRyxDQUFDZSxNQUFKLENBQVdKLElBQVgsRUFBaUIsWUFBWTtFQUN6QkssT0FBTyxDQUFDQyxHQUFSLENBQVksNEJBQVosRUFBMENOLElBQTFDO0FBQ0gsQ0FGRCJ9","map":{"version":3,"names":["dotenv","require","config","app","express","router","Router","use","json","urlencoded","set","static","__dirname","DefaultRouter","port","process","env","PORT_SERVER","listen","console","log"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/","sources":["app.js"],"sourcesContent":["import express from \"express\";\nconst dotenv = require(\"dotenv\");\nimport DefaultRouter from './routes';\n\n\ndotenv.config();\n\nrequire('./database.js')\n\nvar app = express();\nconst router = express.Router();\n\napp.use(express.json()); // Used to parse JSON bodies\napp.use(express.urlencoded()); //Parse URL-encoded bodies\n\napp.set('view engine', 'ejs');\n\napp.use(express.static(__dirname + '/../public'));\n//import routes\napp.use(DefaultRouter);\n\nvar port = process.env.PORT_SERVER || 9000;\n\napp.listen(port, function () {\n    console.log(\"Server Has Started! port: \", port);\n});\n\n"],"mappings":";;AAAA;;AAEA;;;;AADA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AAIAD,MAAM,CAACE,MAAP;;AAEAD,OAAO,CAAC,eAAD,CAAP;;AAEA,IAAIE,GAAG,GAAG,IAAAC,gBAAA,GAAV;;AACA,MAAMC,MAAM,GAAGD,gBAAA,CAAQE,MAAR,EAAf;;AAEAH,GAAG,CAACI,GAAJ,CAAQH,gBAAA,CAAQI,IAAR,EAAR,E,CAAyB;;AACzBL,GAAG,CAACI,GAAJ,CAAQH,gBAAA,CAAQK,UAAR,EAAR,E,CAA+B;;AAE/BN,GAAG,CAACO,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;AAEAP,GAAG,CAACI,GAAJ,CAAQH,gBAAA,CAAQO,MAAR,CAAeC,SAAS,GAAG,YAA3B,CAAR,E,CACA;;AACAT,GAAG,CAACI,GAAJ,CAAQM,eAAR;AAEA,IAAIC,IAAI,GAAGC,OAAO,CAACC,GAAR,CAAYC,WAAZ,IAA2B,IAAtC;AAEAd,GAAG,CAACe,MAAJ,CAAWJ,IAAX,EAAiB,YAAY;EACzBK,OAAO,CAACC,GAAR,CAAY,4BAAZ,EAA0CN,IAA1C;AACH,CAFD"}},"mtime":1656162829145},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/models/User.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require(\"mongoose\");\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  username: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  Role: {\n    type: String,\n    default: 'User',\n    required: true\n  }\n}, {\n  timestamps: true\n});\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJTY2hlbWEiLCJVc2VyU2NoZW1hIiwidXNlcm5hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJlbWFpbCIsInVuaXF1ZSIsInBhc3N3b3JkIiwiUm9sZSIsImRlZmF1bHQiLCJ0aW1lc3RhbXBzIiwiVXNlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL2N5YmVyU2XMgWN1cml0ZcyBL3NpbXBsZWF1dGgvc3JjL21vZGVscy8iLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XG5cbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYTtcbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXNlcm5hbWU6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgIGVtYWlsOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LFxuICAgIHBhc3N3b3JkOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICBSb2xlOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJ1VzZXInLCByZXF1aXJlZDogdHJ1ZSB9LFxuICB9LFxuICB7XG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgfVxuKTtcblxubGV0IFVzZXIgPSBtb25nb29zZS5tb2RlbCgnVXNlcicsIFVzZXJTY2hlbWEpO1xubW9kdWxlLmV4cG9ydHMgPSBVc2VyO1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBRUEsTUFBTUMsTUFBTSxHQUFHRixRQUFRLENBQUNFLE1BQXhCO0FBQ0EsTUFBTUMsVUFBVSxHQUFHLElBQUlELE1BQUosQ0FDakI7RUFDRUUsUUFBUSxFQUFFO0lBQUVDLElBQUksRUFBRUMsTUFBUjtJQUFnQkMsUUFBUSxFQUFFO0VBQTFCLENBRFo7RUFFRUMsS0FBSyxFQUFFO0lBQUVILElBQUksRUFBRUMsTUFBUjtJQUFnQkMsUUFBUSxFQUFFLElBQTFCO0lBQWdDRSxNQUFNLEVBQUU7RUFBeEMsQ0FGVDtFQUdFQyxRQUFRLEVBQUU7SUFBRUwsSUFBSSxFQUFFQyxNQUFSO0lBQWdCQyxRQUFRLEVBQUU7RUFBMUIsQ0FIWjtFQUlFSSxJQUFJLEVBQUU7SUFBRU4sSUFBSSxFQUFFQyxNQUFSO0lBQWdCTSxPQUFPLEVBQUUsTUFBekI7SUFBaUNMLFFBQVEsRUFBRTtFQUEzQztBQUpSLENBRGlCLEVBT2pCO0VBQ0VNLFVBQVUsRUFBRTtBQURkLENBUGlCLENBQW5CO0FBWUEsSUFBSUMsSUFBSSxHQUFHZCxRQUFRLENBQUNlLEtBQVQsQ0FBZSxNQUFmLEVBQXVCWixVQUF2QixDQUFYO0FBQ0FhLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsSUFBakIifQ==","map":{"version":3,"names":["mongoose","require","Schema","UserSchema","username","type","String","required","email","unique","password","Role","default","timestamps","User","model","module","exports"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/models/","sources":["User.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema(\n  {\n    username: { type: String, required: true },\n    email: { type: String, required: true, unique: true },\n    password: { type: String, required: true },\n    Role: { type: String, default: 'User', required: true },\n  },\n  {\n    timestamps: true,\n  }\n);\n\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CACjB;EACEE,QAAQ,EAAE;IAAEC,IAAI,EAAEC,MAAR;IAAgBC,QAAQ,EAAE;EAA1B,CADZ;EAEEC,KAAK,EAAE;IAAEH,IAAI,EAAEC,MAAR;IAAgBC,QAAQ,EAAE,IAA1B;IAAgCE,MAAM,EAAE;EAAxC,CAFT;EAGEC,QAAQ,EAAE;IAAEL,IAAI,EAAEC,MAAR;IAAgBC,QAAQ,EAAE;EAA1B,CAHZ;EAIEI,IAAI,EAAE;IAAEN,IAAI,EAAEC,MAAR;IAAgBM,OAAO,EAAE,MAAzB;IAAiCL,QAAQ,EAAE;EAA3C;AAJR,CADiB,EAOjB;EACEM,UAAU,EAAE;AADd,CAPiB,CAAnB;AAYA,IAAIC,IAAI,GAAGd,QAAQ,CAACe,KAAT,CAAe,MAAf,EAAuBZ,UAAvB,CAAX;AACAa,MAAM,CAACC,OAAP,GAAiBH,IAAjB"}},"mtime":1656163713977},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/database.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nmongoose.connect(`mongodb+srv://EliotAlderson:TestBH-91@cluster0.gbvxg.mongodb.net/cyberProject`).then(() => console.log('Connected to MongoDB')).catch(error => console.log(\"Failed to connect MongoDB\", error));\n/* mongoose\n  .connect( \"mongodb://localhost:27017/cyberProject\")\n  .then(() => console.log(\"Db Connection Successfull!\"))\n  .catch((e) => {\n    console.log(e);\n  });\n */\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJjb25uZWN0IiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvIiwic291cmNlcyI6WyJkYXRhYmFzZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJylcblxubW9uZ29vc2VcbiAgICAuY29ubmVjdChgbW9uZ29kYitzcnY6Ly9FbGlvdEFsZGVyc29uOlRlc3RCSC05MUBjbHVzdGVyMC5nYnZ4Zy5tb25nb2RiLm5ldC9jeWJlclByb2plY3RgKVxuICAgIC50aGVuKCgpID0+IGNvbnNvbGUubG9nKCdDb25uZWN0ZWQgdG8gTW9uZ29EQicpKVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGNvbm5lY3QgTW9uZ29EQlwiLCBlcnJvcikpXG5cblxuLyogbW9uZ29vc2VcbiAgLmNvbm5lY3QoIFwibW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9jeWJlclByb2plY3RcIilcbiAgLnRoZW4oKCkgPT4gY29uc29sZS5sb2coXCJEYiBDb25uZWN0aW9uIFN1Y2Nlc3NmdWxsIVwiKSlcbiAgLmNhdGNoKChlKSA9PiB7XG4gICAgY29uc29sZS5sb2coZSk7XG4gIH0pO1xuICovXG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUF4Qjs7QUFFQUQsUUFBUSxDQUNIRSxPQURMLENBQ2MsK0VBRGQsRUFFS0MsSUFGTCxDQUVVLE1BQU1DLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHNCQUFaLENBRmhCLEVBR0tDLEtBSEwsQ0FHWUMsS0FBRCxJQUFXSCxPQUFPLENBQUNDLEdBQVIsQ0FBWSwyQkFBWixFQUF5Q0UsS0FBekMsQ0FIdEI7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSJ9","map":{"version":3,"names":["mongoose","require","connect","then","console","log","catch","error"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/","sources":["database.js"],"sourcesContent":["const mongoose = require('mongoose')\n\nmongoose\n    .connect(`mongodb+srv://EliotAlderson:TestBH-91@cluster0.gbvxg.mongodb.net/cyberProject`)\n    .then(() => console.log('Connected to MongoDB'))\n    .catch((error) => console.log(\"Failed to connect MongoDB\", error))\n\n\n/* mongoose\n  .connect( \"mongodb://localhost:27017/cyberProject\")\n  .then(() => console.log(\"Db Connection Successfull!\"))\n  .catch((e) => {\n    console.log(e);\n  });\n */\n"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CACHE,OADL,CACc,+EADd,EAEKC,IAFL,CAEU,MAAMC,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAFhB,EAGKC,KAHL,CAGYC,KAAD,IAAWH,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCE,KAAzC,CAHtB;AAMA;AACA;AACA;AACA;AACA;AACA;AACA"}},"mtime":1656158577736},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/models/User.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require(\"mongoose\");\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  username: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  Role: {\n    type: String,\n    default: 'User',\n    required: true\n  }\n}, {\n  timestamps: true\n});\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJTY2hlbWEiLCJVc2VyU2NoZW1hIiwidXNlcm5hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJlbWFpbCIsInVuaXF1ZSIsInBhc3N3b3JkIiwiUm9sZSIsImRlZmF1bHQiLCJ0aW1lc3RhbXBzIiwiVXNlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL2N5YmVyU2XMgWN1cml0ZcyBL3NpbXBsZWF1dGgvc3JjL21vZGVscy8iLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XG5cbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYTtcbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXNlcm5hbWU6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgIGVtYWlsOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LFxuICAgIHBhc3N3b3JkOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICBSb2xlOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJ1VzZXInLCByZXF1aXJlZDogdHJ1ZSB9LFxuICB9LFxuICB7XG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgfVxuKTtcblxubGV0IFVzZXIgPSBtb25nb29zZS5tb2RlbCgnVXNlcicsIFVzZXJTY2hlbWEpO1xubW9kdWxlLmV4cG9ydHMgPSBVc2VyO1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBRUEsTUFBTUMsTUFBTSxHQUFHRixRQUFRLENBQUNFLE1BQXhCO0FBQ0EsTUFBTUMsVUFBVSxHQUFHLElBQUlELE1BQUosQ0FDakI7RUFDRUUsUUFBUSxFQUFFO0lBQUVDLElBQUksRUFBRUMsTUFBUjtJQUFnQkMsUUFBUSxFQUFFO0VBQTFCLENBRFo7RUFFRUMsS0FBSyxFQUFFO0lBQUVILElBQUksRUFBRUMsTUFBUjtJQUFnQkMsUUFBUSxFQUFFLElBQTFCO0lBQWdDRSxNQUFNLEVBQUU7RUFBeEMsQ0FGVDtFQUdFQyxRQUFRLEVBQUU7SUFBRUwsSUFBSSxFQUFFQyxNQUFSO0lBQWdCQyxRQUFRLEVBQUU7RUFBMUIsQ0FIWjtFQUlFSSxJQUFJLEVBQUU7SUFBRU4sSUFBSSxFQUFFQyxNQUFSO0lBQWdCTSxPQUFPLEVBQUUsTUFBekI7SUFBaUNMLFFBQVEsRUFBRTtFQUEzQztBQUpSLENBRGlCLEVBT2pCO0VBQ0VNLFVBQVUsRUFBRTtBQURkLENBUGlCLENBQW5CO0FBWUEsSUFBSUMsSUFBSSxHQUFHZCxRQUFRLENBQUNlLEtBQVQsQ0FBZSxNQUFmLEVBQXVCWixVQUF2QixDQUFYO0FBQ0FhLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsSUFBakIifQ==","map":{"version":3,"names":["mongoose","require","Schema","UserSchema","username","type","String","required","email","unique","password","Role","default","timestamps","User","model","module","exports"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/models/","sources":["User.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema(\n  {\n    username: { type: String, required: true },\n    email: { type: String, required: true, unique: true },\n    password: { type: String, required: true },\n    Role: { type: String, default: 'User', required: true },\n  },\n  {\n    timestamps: true,\n  }\n);\n\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CACjB;EACEE,QAAQ,EAAE;IAAEC,IAAI,EAAEC,MAAR;IAAgBC,QAAQ,EAAE;EAA1B,CADZ;EAEEC,KAAK,EAAE;IAAEH,IAAI,EAAEC,MAAR;IAAgBC,QAAQ,EAAE,IAA1B;IAAgCE,MAAM,EAAE;EAAxC,CAFT;EAGEC,QAAQ,EAAE;IAAEL,IAAI,EAAEC,MAAR;IAAgBC,QAAQ,EAAE;EAA1B,CAHZ;EAIEI,IAAI,EAAE;IAAEN,IAAI,EAAEC,MAAR;IAAgBM,OAAO,EAAE,MAAzB;IAAiCL,QAAQ,EAAE;EAA3C;AAJR,CADiB,EAOjB;EACEM,UAAU,EAAE;AADd,CAPiB,CAAnB;AAYA,IAAIC,IAAI,GAAGd,QAAQ,CAACe,KAAT,CAAe,MAAf,EAAuBZ,UAAvB,CAAX;AACAa,MAAM,CAACC,OAAP,GAAiBH,IAAjB"}},"mtime":1656163713977},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/database.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nmongoose.connect(`mongodb+srv://EliotAlderson:TestBH-91@cluster0.gbvxg.mongodb.net/cyberProject`).then(() => console.log('Connected to MongoDB')).catch(error => console.log(\"Failed to connect MongoDB\", error));\n/* mongoose\n  .connect( \"mongodb://localhost:27017/cyberProject\")\n  .then(() => console.log(\"Db Connection Successfull!\"))\n  .catch((e) => {\n    console.log(e);\n  });\n */\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJjb25uZWN0IiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvIiwic291cmNlcyI6WyJkYXRhYmFzZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJylcblxubW9uZ29vc2VcbiAgICAuY29ubmVjdChgbW9uZ29kYitzcnY6Ly9FbGlvdEFsZGVyc29uOlRlc3RCSC05MUBjbHVzdGVyMC5nYnZ4Zy5tb25nb2RiLm5ldC9jeWJlclByb2plY3RgKVxuICAgIC50aGVuKCgpID0+IGNvbnNvbGUubG9nKCdDb25uZWN0ZWQgdG8gTW9uZ29EQicpKVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGNvbm5lY3QgTW9uZ29EQlwiLCBlcnJvcikpXG5cblxuLyogbW9uZ29vc2VcbiAgLmNvbm5lY3QoIFwibW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9jeWJlclByb2plY3RcIilcbiAgLnRoZW4oKCkgPT4gY29uc29sZS5sb2coXCJEYiBDb25uZWN0aW9uIFN1Y2Nlc3NmdWxsIVwiKSlcbiAgLmNhdGNoKChlKSA9PiB7XG4gICAgY29uc29sZS5sb2coZSk7XG4gIH0pO1xuICovXG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUF4Qjs7QUFFQUQsUUFBUSxDQUNIRSxPQURMLENBQ2MsK0VBRGQsRUFFS0MsSUFGTCxDQUVVLE1BQU1DLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHNCQUFaLENBRmhCLEVBR0tDLEtBSEwsQ0FHWUMsS0FBRCxJQUFXSCxPQUFPLENBQUNDLEdBQVIsQ0FBWSwyQkFBWixFQUF5Q0UsS0FBekMsQ0FIdEI7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSJ9","map":{"version":3,"names":["mongoose","require","connect","then","console","log","catch","error"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/","sources":["database.js"],"sourcesContent":["const mongoose = require('mongoose')\n\nmongoose\n    .connect(`mongodb+srv://EliotAlderson:TestBH-91@cluster0.gbvxg.mongodb.net/cyberProject`)\n    .then(() => console.log('Connected to MongoDB'))\n    .catch((error) => console.log(\"Failed to connect MongoDB\", error))\n\n\n/* mongoose\n  .connect( \"mongodb://localhost:27017/cyberProject\")\n  .then(() => console.log(\"Db Connection Successfull!\"))\n  .catch((e) => {\n    console.log(e);\n  });\n */\n"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CACHE,OADL,CACc,+EADd,EAEKC,IAFL,CAEU,MAAMC,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAFhB,EAGKC,KAHL,CAGYC,KAAD,IAAWH,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCE,KAAzC,CAHtB;AAMA;AACA;AACA;AACA;AACA;AACA;AACA"}},"mtime":1656158577736},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkEmail = checkEmail;\nexports.cleanData = cleanData;\nexports.validate = validate;\n\nfunction cleanData(data) {\n  data.username = data.username.replace(/(<([^>]+)>)/ig, '');\n  return data;\n}\n\nfunction validate(data) {\n  var str = data.password;\n  var str2 = data.passwordConfirm;\n\n  if (str != str2) {\n    return false;\n  }\n\n  if (str.match(/[0-9]/g) && str.match(/[A-Z]/g) && str.match(/[a-z]/g) && str.match(/[^a-zA-Z\\d]/g) && str.length >= 12) {\n    return true;\n  } else {\n    console.log(\"validate false\");\n    return false;\n  }\n}\n\nfunction checkEmail(data) {\n  var mailformat = /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/;\n\n  if (data.match(mailformat)) {\n    return true;\n  } else {\n    alert(\"Vous avez saisi une adresse électronique non valide !\");\n    return false;\n  }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjbGVhbkRhdGEiLCJkYXRhIiwidXNlcm5hbWUiLCJyZXBsYWNlIiwidmFsaWRhdGUiLCJzdHIiLCJwYXNzd29yZCIsInN0cjIiLCJwYXNzd29yZENvbmZpcm0iLCJtYXRjaCIsImxlbmd0aCIsImNvbnNvbGUiLCJsb2ciLCJjaGVja0VtYWlsIiwibWFpbGZvcm1hdCIsImFsZXJ0Il0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvIiwic291cmNlcyI6WyJ1dGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gY2xlYW5EYXRhKGRhdGEpIHtcbiAgICBkYXRhLnVzZXJuYW1lID0gZGF0YS51c2VybmFtZS5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJycpO1xuICAgIHJldHVybiBkYXRhO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUoZGF0YSkge1xuICAgIHZhciBzdHIgPSBkYXRhLnBhc3N3b3JkO1xuICAgIHZhciBzdHIyID0gZGF0YS5wYXNzd29yZENvbmZpcm07XG4gICAgaWYgKHN0ciAhPSBzdHIyKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIGlmIChzdHIubWF0Y2goL1swLTldL2cpICYmXG4gICAgICAgIHN0ci5tYXRjaCgvW0EtWl0vZykgJiZcbiAgICAgICAgc3RyLm1hdGNoKC9bYS16XS9nKSAmJlxuICAgICAgICBzdHIubWF0Y2goL1teYS16QS1aXFxkXS9nKSAmJlxuICAgICAgICBzdHIubGVuZ3RoID49IDEyKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ2YWxpZGF0ZSBmYWxzZVwiKVxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja0VtYWlsKGRhdGEpIHtcbiAgICB2YXIgbWFpbGZvcm1hdCA9IC9eXFx3KyhbXFwuLV0/XFx3KykqQFxcdysoW1xcLi1dP1xcdyspKihcXC5cXHd7MiwzfSkrJC87XG4gICAgaWYgKGRhdGEubWF0Y2gobWFpbGZvcm1hdCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhbGVydChcIlZvdXMgYXZleiBzYWlzaSB1bmUgYWRyZXNzZSDDqWxlY3Ryb25pcXVlIG5vbiB2YWxpZGUgIVwiKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFPLFNBQVNBLFNBQVQsQ0FBbUJDLElBQW5CLEVBQXlCO0VBQzVCQSxJQUFJLENBQUNDLFFBQUwsR0FBZ0JELElBQUksQ0FBQ0MsUUFBTCxDQUFjQyxPQUFkLENBQXNCLGVBQXRCLEVBQXVDLEVBQXZDLENBQWhCO0VBQ0EsT0FBT0YsSUFBUDtBQUNIOztBQUVNLFNBQVNHLFFBQVQsQ0FBa0JILElBQWxCLEVBQXdCO0VBQzNCLElBQUlJLEdBQUcsR0FBR0osSUFBSSxDQUFDSyxRQUFmO0VBQ0EsSUFBSUMsSUFBSSxHQUFHTixJQUFJLENBQUNPLGVBQWhCOztFQUNBLElBQUlILEdBQUcsSUFBSUUsSUFBWCxFQUFpQjtJQUNiLE9BQU8sS0FBUDtFQUNIOztFQUVELElBQUlGLEdBQUcsQ0FBQ0ksS0FBSixDQUFVLFFBQVYsS0FDQUosR0FBRyxDQUFDSSxLQUFKLENBQVUsUUFBVixDQURBLElBRUFKLEdBQUcsQ0FBQ0ksS0FBSixDQUFVLFFBQVYsQ0FGQSxJQUdBSixHQUFHLENBQUNJLEtBQUosQ0FBVSxjQUFWLENBSEEsSUFJQUosR0FBRyxDQUFDSyxNQUFKLElBQWMsRUFKbEIsRUFJc0I7SUFDbEIsT0FBTyxJQUFQO0VBQ0gsQ0FORCxNQU9LO0lBQ0RDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdCQUFaO0lBQ0EsT0FBTyxLQUFQO0VBQ0g7QUFDSjs7QUFFTSxTQUFTQyxVQUFULENBQW9CWixJQUFwQixFQUEwQjtFQUM3QixJQUFJYSxVQUFVLEdBQUcsK0NBQWpCOztFQUNBLElBQUliLElBQUksQ0FBQ1EsS0FBTCxDQUFXSyxVQUFYLENBQUosRUFBNEI7SUFDeEIsT0FBTyxJQUFQO0VBQ0gsQ0FGRCxNQUdLO0lBQ0RDLEtBQUssQ0FBQyx1REFBRCxDQUFMO0lBQ0EsT0FBTyxLQUFQO0VBQ0g7QUFDSiJ9","map":{"version":3,"names":["cleanData","data","username","replace","validate","str","password","str2","passwordConfirm","match","length","console","log","checkEmail","mailformat","alert"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/","sources":["utils.js"],"sourcesContent":["export function cleanData(data) {\n    data.username = data.username.replace(/(<([^>]+)>)/ig, '');\n    return data;\n}\n\nexport function validate(data) {\n    var str = data.password;\n    var str2 = data.passwordConfirm;\n    if (str != str2) {\n        return false\n    }\n\n    if (str.match(/[0-9]/g) &&\n        str.match(/[A-Z]/g) &&\n        str.match(/[a-z]/g) &&\n        str.match(/[^a-zA-Z\\d]/g) &&\n        str.length >= 12) {\n        return true;\n    }\n    else {\n        console.log(\"validate false\")\n        return false\n    }\n}\n\nexport function checkEmail(data) {\n    var mailformat = /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/;\n    if (data.match(mailformat)) {\n        return true;\n    }\n    else {\n        alert(\"Vous avez saisi une adresse électronique non valide !\");\n        return false;\n    }\n}"],"mappings":";;;;;;;;;AAAO,SAASA,SAAT,CAAmBC,IAAnB,EAAyB;EAC5BA,IAAI,CAACC,QAAL,GAAgBD,IAAI,CAACC,QAAL,CAAcC,OAAd,CAAsB,eAAtB,EAAuC,EAAvC,CAAhB;EACA,OAAOF,IAAP;AACH;;AAEM,SAASG,QAAT,CAAkBH,IAAlB,EAAwB;EAC3B,IAAII,GAAG,GAAGJ,IAAI,CAACK,QAAf;EACA,IAAIC,IAAI,GAAGN,IAAI,CAACO,eAAhB;;EACA,IAAIH,GAAG,IAAIE,IAAX,EAAiB;IACb,OAAO,KAAP;EACH;;EAED,IAAIF,GAAG,CAACI,KAAJ,CAAU,QAAV,KACAJ,GAAG,CAACI,KAAJ,CAAU,QAAV,CADA,IAEAJ,GAAG,CAACI,KAAJ,CAAU,QAAV,CAFA,IAGAJ,GAAG,CAACI,KAAJ,CAAU,cAAV,CAHA,IAIAJ,GAAG,CAACK,MAAJ,IAAc,EAJlB,EAIsB;IAClB,OAAO,IAAP;EACH,CAND,MAOK;IACDC,OAAO,CAACC,GAAR,CAAY,gBAAZ;IACA,OAAO,KAAP;EACH;AACJ;;AAEM,SAASC,UAAT,CAAoBZ,IAApB,EAA0B;EAC7B,IAAIa,UAAU,GAAG,+CAAjB;;EACA,IAAIb,IAAI,CAACQ,KAAL,CAAWK,UAAX,CAAJ,EAA4B;IACxB,OAAO,IAAP;EACH,CAFD,MAGK;IACDC,KAAK,CAAC,uDAAD,CAAL;IACA,OAAO,KAAP;EACH;AACJ"}},"mtime":1656157851980},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkEmail = checkEmail;\nexports.cleanData = cleanData;\nexports.validate = validate;\n\nfunction cleanData(data) {\n  data.username = data.username.replace(/(<([^>]+)>)/ig, '');\n  return data;\n}\n\nfunction validate(data) {\n  var str = data.password;\n  var str2 = data.passwordConfirm;\n\n  if (str != str2) {\n    return false;\n  }\n\n  if (str.match(/[0-9]/g) && str.match(/[A-Z]/g) && str.match(/[a-z]/g) && str.match(/[^a-zA-Z\\d]/g) && str.length >= 12) {\n    return true;\n  } else {\n    console.log(\"validate false\");\n    return false;\n  }\n}\n\nfunction checkEmail(data) {\n  var mailformat = /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/;\n\n  if (data.match(mailformat)) {\n    return true;\n  } else {\n    alert(\"Vous avez saisi une adresse électronique non valide !\");\n    return false;\n  }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjbGVhbkRhdGEiLCJkYXRhIiwidXNlcm5hbWUiLCJyZXBsYWNlIiwidmFsaWRhdGUiLCJzdHIiLCJwYXNzd29yZCIsInN0cjIiLCJwYXNzd29yZENvbmZpcm0iLCJtYXRjaCIsImxlbmd0aCIsImNvbnNvbGUiLCJsb2ciLCJjaGVja0VtYWlsIiwibWFpbGZvcm1hdCIsImFsZXJ0Il0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvIiwic291cmNlcyI6WyJ1dGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gY2xlYW5EYXRhKGRhdGEpIHtcbiAgICBkYXRhLnVzZXJuYW1lID0gZGF0YS51c2VybmFtZS5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJycpO1xuICAgIHJldHVybiBkYXRhO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUoZGF0YSkge1xuICAgIHZhciBzdHIgPSBkYXRhLnBhc3N3b3JkO1xuICAgIHZhciBzdHIyID0gZGF0YS5wYXNzd29yZENvbmZpcm07XG4gICAgaWYgKHN0ciAhPSBzdHIyKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIGlmIChzdHIubWF0Y2goL1swLTldL2cpICYmXG4gICAgICAgIHN0ci5tYXRjaCgvW0EtWl0vZykgJiZcbiAgICAgICAgc3RyLm1hdGNoKC9bYS16XS9nKSAmJlxuICAgICAgICBzdHIubWF0Y2goL1teYS16QS1aXFxkXS9nKSAmJlxuICAgICAgICBzdHIubGVuZ3RoID49IDEyKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ2YWxpZGF0ZSBmYWxzZVwiKVxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja0VtYWlsKGRhdGEpIHtcbiAgICB2YXIgbWFpbGZvcm1hdCA9IC9eXFx3KyhbXFwuLV0/XFx3KykqQFxcdysoW1xcLi1dP1xcdyspKihcXC5cXHd7MiwzfSkrJC87XG4gICAgaWYgKGRhdGEubWF0Y2gobWFpbGZvcm1hdCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhbGVydChcIlZvdXMgYXZleiBzYWlzaSB1bmUgYWRyZXNzZSDDqWxlY3Ryb25pcXVlIG5vbiB2YWxpZGUgIVwiKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFPLFNBQVNBLFNBQVQsQ0FBbUJDLElBQW5CLEVBQXlCO0VBQzVCQSxJQUFJLENBQUNDLFFBQUwsR0FBZ0JELElBQUksQ0FBQ0MsUUFBTCxDQUFjQyxPQUFkLENBQXNCLGVBQXRCLEVBQXVDLEVBQXZDLENBQWhCO0VBQ0EsT0FBT0YsSUFBUDtBQUNIOztBQUVNLFNBQVNHLFFBQVQsQ0FBa0JILElBQWxCLEVBQXdCO0VBQzNCLElBQUlJLEdBQUcsR0FBR0osSUFBSSxDQUFDSyxRQUFmO0VBQ0EsSUFBSUMsSUFBSSxHQUFHTixJQUFJLENBQUNPLGVBQWhCOztFQUNBLElBQUlILEdBQUcsSUFBSUUsSUFBWCxFQUFpQjtJQUNiLE9BQU8sS0FBUDtFQUNIOztFQUVELElBQUlGLEdBQUcsQ0FBQ0ksS0FBSixDQUFVLFFBQVYsS0FDQUosR0FBRyxDQUFDSSxLQUFKLENBQVUsUUFBVixDQURBLElBRUFKLEdBQUcsQ0FBQ0ksS0FBSixDQUFVLFFBQVYsQ0FGQSxJQUdBSixHQUFHLENBQUNJLEtBQUosQ0FBVSxjQUFWLENBSEEsSUFJQUosR0FBRyxDQUFDSyxNQUFKLElBQWMsRUFKbEIsRUFJc0I7SUFDbEIsT0FBTyxJQUFQO0VBQ0gsQ0FORCxNQU9LO0lBQ0RDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdCQUFaO0lBQ0EsT0FBTyxLQUFQO0VBQ0g7QUFDSjs7QUFFTSxTQUFTQyxVQUFULENBQW9CWixJQUFwQixFQUEwQjtFQUM3QixJQUFJYSxVQUFVLEdBQUcsK0NBQWpCOztFQUNBLElBQUliLElBQUksQ0FBQ1EsS0FBTCxDQUFXSyxVQUFYLENBQUosRUFBNEI7SUFDeEIsT0FBTyxJQUFQO0VBQ0gsQ0FGRCxNQUdLO0lBQ0RDLEtBQUssQ0FBQyx1REFBRCxDQUFMO0lBQ0EsT0FBTyxLQUFQO0VBQ0g7QUFDSiJ9","map":{"version":3,"names":["cleanData","data","username","replace","validate","str","password","str2","passwordConfirm","match","length","console","log","checkEmail","mailformat","alert"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/","sources":["utils.js"],"sourcesContent":["export function cleanData(data) {\n    data.username = data.username.replace(/(<([^>]+)>)/ig, '');\n    return data;\n}\n\nexport function validate(data) {\n    var str = data.password;\n    var str2 = data.passwordConfirm;\n    if (str != str2) {\n        return false\n    }\n\n    if (str.match(/[0-9]/g) &&\n        str.match(/[A-Z]/g) &&\n        str.match(/[a-z]/g) &&\n        str.match(/[^a-zA-Z\\d]/g) &&\n        str.length >= 12) {\n        return true;\n    }\n    else {\n        console.log(\"validate false\")\n        return false\n    }\n}\n\nexport function checkEmail(data) {\n    var mailformat = /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/;\n    if (data.match(mailformat)) {\n        return true;\n    }\n    else {\n        alert(\"Vous avez saisi une adresse électronique non valide !\");\n        return false;\n    }\n}"],"mappings":";;;;;;;;;AAAO,SAASA,SAAT,CAAmBC,IAAnB,EAAyB;EAC5BA,IAAI,CAACC,QAAL,GAAgBD,IAAI,CAACC,QAAL,CAAcC,OAAd,CAAsB,eAAtB,EAAuC,EAAvC,CAAhB;EACA,OAAOF,IAAP;AACH;;AAEM,SAASG,QAAT,CAAkBH,IAAlB,EAAwB;EAC3B,IAAII,GAAG,GAAGJ,IAAI,CAACK,QAAf;EACA,IAAIC,IAAI,GAAGN,IAAI,CAACO,eAAhB;;EACA,IAAIH,GAAG,IAAIE,IAAX,EAAiB;IACb,OAAO,KAAP;EACH;;EAED,IAAIF,GAAG,CAACI,KAAJ,CAAU,QAAV,KACAJ,GAAG,CAACI,KAAJ,CAAU,QAAV,CADA,IAEAJ,GAAG,CAACI,KAAJ,CAAU,QAAV,CAFA,IAGAJ,GAAG,CAACI,KAAJ,CAAU,cAAV,CAHA,IAIAJ,GAAG,CAACK,MAAJ,IAAc,EAJlB,EAIsB;IAClB,OAAO,IAAP;EACH,CAND,MAOK;IACDC,OAAO,CAACC,GAAR,CAAY,gBAAZ;IACA,OAAO,KAAP;EACH;AACJ;;AAEM,SAASC,UAAT,CAAoBZ,IAApB,EAA0B;EAC7B,IAAIa,UAAU,GAAG,+CAAjB;;EACA,IAAIb,IAAI,CAACQ,KAAL,CAAWK,UAAX,CAAJ,EAA4B;IACxB,OAAO,IAAP;EACH,CAFD,MAGK;IACDC,KAAK,CAAC,uDAAD,CAAL;IACA,OAAO,KAAP;EACH;AACJ"}},"mtime":1656157851980},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar _utils = require(\"../utils\");\n\nvar _cryptoJs = _interopRequireDefault(require(\"crypto-js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst User = require('../models/User');\n\nconst router = (0, _express.Router)();\nrouter.get(\"/\", function (req, res) {\n  res.render('index');\n});\nrouter.get(\"/register\", function (req, res) {\n  res.render('register');\n});\nrouter.post('/register', async function (req, res) {\n  let data = req.body;\n  let newData = (0, _utils.cleanData)(data);\n  console.log(newData);\n\n  if (!(0, _utils.validate)(newData) || !(0, _utils.checkEmail)(newData.email)) {\n    res.send(\"donnée(s) incorrecte(s)\");\n  } else {\n    //3- if success redirect to login\n    try {\n      let {\n        username,\n        email,\n        password\n      } = newData;\n      password = _cryptoJs.default.AES.encrypt(password, process.env.PASS_SEC).toString();\n      const user = await User.create({\n        username,\n        email,\n        password\n      });\n      res.status(201).render('login');\n    } catch (err) {\n      //const errors = signUpErrors(err)\n      res.status(200).send(err);\n    }\n  }\n}); //Showing login form\n\nrouter.get(\"/login\", function (req, res) {\n  res.render('login');\n});\nrouter.post('/login', async function (req, res) {\n  //1- get data \n  console.log(req.body); //2- authenticate user \n\n  try {\n    const user = await User.findOne({\n      username: req.body.username\n    });\n    !user && res.status(401).json(\"Wrong Credentials !!!\");\n\n    const originalPassword = _cryptoJs.default.AES.decrypt(user.password, process.env.PASS_SEC).toString(_cryptoJs.default.enc.Utf8);\n\n    originalPassword !== req.body.password && res.status(401).send({\n      message: \"Le mot de passe ou l'email ne correspond pas.\"\n    });\n    console.log(user);\n    res.render('home');\n  } catch (e) {\n    res.status(500).json(e);\n  } //3- if success redirect to home page \n\n});\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImdldCIsInJlcSIsInJlcyIsInJlbmRlciIsInBvc3QiLCJkYXRhIiwiYm9keSIsIm5ld0RhdGEiLCJjbGVhbkRhdGEiLCJjb25zb2xlIiwibG9nIiwidmFsaWRhdGUiLCJjaGVja0VtYWlsIiwiZW1haWwiLCJzZW5kIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsIkNyeXB0b0pTIiwiQUVTIiwiZW5jcnlwdCIsInByb2Nlc3MiLCJlbnYiLCJQQVNTX1NFQyIsInRvU3RyaW5nIiwidXNlciIsImNyZWF0ZSIsInN0YXR1cyIsImVyciIsImZpbmRPbmUiLCJqc29uIiwib3JpZ2luYWxQYXNzd29yZCIsImRlY3J5cHQiLCJlbmMiLCJVdGY4IiwibWVzc2FnZSIsImUiXSwic291cmNlUm9vdCI6Ii9BcHBsaWNhdGlvbnMvZG9zc2llci9jeWJlclNlzIFjdXJpdGXMgS9zaW1wbGVhdXRoL3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCB7Y2xlYW5EYXRhICwgdmFsaWRhdGUsIGNoZWNrRW1haWx9IGZyb20gJy4uL3V0aWxzJztcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbHMvVXNlcicpXG5pbXBvcnQgQ3J5cHRvSlMgZnJvbSBcImNyeXB0by1qc1wiO1xuXG5cbmNvbnN0IHJvdXRlciA9IFJvdXRlcigpO1xuXG5yb3V0ZXIuZ2V0KFwiL1wiLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICByZXMucmVuZGVyKCdpbmRleCcpO1xufSk7XG5cbnJvdXRlci5nZXQoXCIvcmVnaXN0ZXJcIiwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gICAgcmVzLnJlbmRlcigncmVnaXN0ZXInKTtcbn0pO1xuXG5yb3V0ZXIucG9zdCgnL3JlZ2lzdGVyJywgYXN5bmMgZnVuY3Rpb24ocmVxLCByZXMpe1xuICAgIGxldCBkYXRhID0gcmVxLmJvZHk7XG4gICAgbGV0IG5ld0RhdGEgPSBjbGVhbkRhdGEoZGF0YSk7ICBcbiAgICBjb25zb2xlLmxvZyhuZXdEYXRhKVxuICAgIGlmICghdmFsaWRhdGUobmV3RGF0YSkgfHwgIWNoZWNrRW1haWwobmV3RGF0YS5lbWFpbCkpIHtcbiAgICAgIHJlcy5zZW5kKFwiZG9ubsOpZShzKSBpbmNvcnJlY3RlKHMpXCIpO1xuICAgIH1cbiAgICBlbHNle1xuICAgICAgLy8zLSBpZiBzdWNjZXNzIHJlZGlyZWN0IHRvIGxvZ2luXG4gICAgICB0cnkge1xuICAgICAgICBsZXQgeyB1c2VybmFtZSwgZW1haWwsIHBhc3N3b3JkIH0gPSBuZXdEYXRhXG4gICAgICAgIHBhc3N3b3JkID0gQ3J5cHRvSlMuQUVTLmVuY3J5cHQocGFzc3dvcmQscHJvY2Vzcy5lbnYuUEFTU19TRUMpLnRvU3RyaW5nKCk7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmNyZWF0ZSh7IHVzZXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQgfSlcbiAgICAgICAgcmVzLnN0YXR1cygyMDEpLnJlbmRlcignbG9naW4nKTtcbiAgICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vY29uc3QgZXJyb3JzID0gc2lnblVwRXJyb3JzKGVycilcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoZXJyKVxuICAgIH1cbiAgICB9XG4gfSk7XG5cbiAvL1Nob3dpbmcgbG9naW4gZm9ybVxucm91dGVyLmdldChcIi9sb2dpblwiLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICByZXMucmVuZGVyKCdsb2dpbicpO1xufSk7XG5cbnJvdXRlci5wb3N0KCcvbG9naW4nLCBhc3luYyBmdW5jdGlvbihyZXEsIHJlcyl7XG4gICAgLy8xLSBnZXQgZGF0YSBcbiAgICBjb25zb2xlLmxvZyhyZXEuYm9keSk7XG4gICAgLy8yLSBhdXRoZW50aWNhdGUgdXNlciBcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgdXNlcm5hbWU6IHJlcS5ib2R5LnVzZXJuYW1lIH0pO1xuICAgICAgICAhdXNlciAmJiByZXMuc3RhdHVzKDQwMSkuanNvbihcIldyb25nIENyZWRlbnRpYWxzICEhIVwiKTtcbiAgICBcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxQYXNzd29yZCA9IENyeXB0b0pTLkFFUy5kZWNyeXB0KFxuICAgICAgICAgIHVzZXIucGFzc3dvcmQsXG4gICAgICAgICAgcHJvY2Vzcy5lbnYuUEFTU19TRUNcbiAgICAgICAgKS50b1N0cmluZyhDcnlwdG9KUy5lbmMuVXRmOCk7XG4gICAgXG4gICAgICAgIG9yaWdpbmFsUGFzc3dvcmQgIT09IHJlcS5ib2R5LnBhc3N3b3JkICYmXG4gICAgICAgICAgcmVzXG4gICAgICAgICAgICAuc3RhdHVzKDQwMSlcbiAgICAgICAgICAgIC5zZW5kKHsgbWVzc2FnZTogXCJMZSBtb3QgZGUgcGFzc2Ugb3UgbCdlbWFpbCBuZSBjb3JyZXNwb25kIHBhcy5cIiB9KTtcbiAgICAgICAgY29uc29sZS5sb2codXNlcilcbiAgICAgICAgcmVzLnJlbmRlcignaG9tZScpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbihlKTtcbiAgICAgIH1cbiAgICAvLzMtIGlmIHN1Y2Nlc3MgcmVkaXJlY3QgdG8gaG9tZSBwYWdlIFxuICBcbiB9KTtcblxuZXhwb3J0IGRlZmF1bHQgcm91dGVyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBRUE7Ozs7QUFEQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxnQkFBRCxDQUFwQjs7QUFJQSxNQUFNQyxNQUFNLEdBQUcsSUFBQUMsZUFBQSxHQUFmO0FBRUFELE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLEdBQVgsRUFBZ0IsVUFBVUMsR0FBVixFQUFlQyxHQUFmLEVBQW9CO0VBQ2hDQSxHQUFHLENBQUNDLE1BQUosQ0FBVyxP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","map":{"version":3,"names":["User","require","router","Router","get","req","res","render","post","data","body","newData","cleanData","console","log","validate","checkEmail","email","send","username","password","CryptoJS","AES","encrypt","process","env","PASS_SEC","toString","user","create","status","err","findOne","json","originalPassword","decrypt","enc","Utf8","message","e"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/routes/","sources":["index.js"],"sourcesContent":["import { Router } from 'express';\nimport {cleanData , validate, checkEmail} from '../utils';\nconst User = require('../models/User')\nimport CryptoJS from \"crypto-js\";\n\n\nconst router = Router();\n\nrouter.get(\"/\", function (req, res) {\n    res.render('index');\n});\n\nrouter.get(\"/register\", function (req, res) {\n    res.render('register');\n});\n\nrouter.post('/register', async function(req, res){\n    let data = req.body;\n    let newData = cleanData(data);  \n    console.log(newData)\n    if (!validate(newData) || !checkEmail(newData.email)) {\n      res.send(\"donnée(s) incorrecte(s)\");\n    }\n    else{\n      //3- if success redirect to login\n      try {\n        let { username, email, password } = newData\n        password = CryptoJS.AES.encrypt(password,process.env.PASS_SEC).toString();\n        const user = await User.create({ username, email, password })\n        res.status(201).render('login');\n      }\n    catch (err) {\n        //const errors = signUpErrors(err)\n        res.status(200).send(err)\n    }\n    }\n });\n\n //Showing login form\nrouter.get(\"/login\", function (req, res) {\n    res.render('login');\n});\n\nrouter.post('/login', async function(req, res){\n    //1- get data \n    console.log(req.body);\n    //2- authenticate user \n    try {\n        const user = await User.findOne({ username: req.body.username });\n        !user && res.status(401).json(\"Wrong Credentials !!!\");\n    \n        const originalPassword = CryptoJS.AES.decrypt(\n          user.password,\n          process.env.PASS_SEC\n        ).toString(CryptoJS.enc.Utf8);\n    \n        originalPassword !== req.body.password &&\n          res\n            .status(401)\n            .send({ message: \"Le mot de passe ou l'email ne correspond pas.\" });\n        console.log(user)\n        res.render('home');\n      } catch (e) {\n        res.status(500).json(e);\n      }\n    //3- if success redirect to home page \n  \n });\n\nexport default router;\n"],"mappings":"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"}},"mtime":1656162673021},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar _utils = require(\"../utils\");\n\nvar _cryptoJs = _interopRequireDefault(require(\"crypto-js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst User = require('../models/User');\n\nconst AccessControl = require('accesscontrol');\n\nconst router = (0, _express.Router)();\nrouter.get(\"/\", function (req, res) {\n  res.render('index');\n});\nrouter.get(\"/register\", function (req, res) {\n  res.render('register');\n});\nrouter.post('/register', async function (req, res) {\n  let data = req.body;\n  let newData = (0, _utils.cleanData)(data);\n  console.log(newData);\n\n  if (!(0, _utils.validate)(newData) || !(0, _utils.checkEmail)(newData.email)) {\n    res.send(\"donnée(s) incorrecte(s)\");\n  } else {\n    //persist user in database\n    try {\n      let {\n        username,\n        email,\n        password\n      } = newData;\n      password = _cryptoJs.default.AES.encrypt(password, process.env.PASS_SEC).toString();\n      const user = await User.create({\n        username,\n        email,\n        password\n      });\n      res.status(201).render('login');\n    } //if error then send error \n    catch (err) {\n      //const errors = signUpErrors(err)\n      res.status(200).send(err);\n    }\n  }\n}); //Showing login form\n\nrouter.get(\"/login\", function (req, res) {\n  res.render('login');\n});\nrouter.post('/login', async function (req, res) {\n  //1- get data \n  console.log(req.body); //2- authenticate user \n\n  try {\n    const user = await User.findOne({\n      username: req.body.username\n    });\n    console.log(user);\n\n    if (!user) {\n      res.status(401).json(\"Utilisateur inconnu !!!\");\n    } else {\n      const originalPassword = _cryptoJs.default.AES.decrypt(user.password, process.env.PASS_SEC).toString(_cryptoJs.default.enc.Utf8);\n\n      originalPassword !== req.body.password ? res.status(401).send({\n        message: \"Le mot de passe ne correspond pas.\"\n      }) : res.render('home');\n    }\n  } catch (e) {\n    res.status(500).json(e);\n  } //3- if success redirect to home page \n\n});\n\nconst authenticate = () => {\n  const ac = new AccessControl();\n\n  exports.roles = function () {\n    ac.grant(\"User\").readOwn(\"profile\").updateOwn(\"profile\");\n    ac.grant(\"Admin\").extend(\"user\").readAny(\"profile\").updateAny(\"profile\").deleteAny(\"profile\");\n    console.log(ac);\n    return ac;\n  };\n};\n\nrouter.get(\"/allusers\", authenticate, async (req, res) => {\n  try {\n    const users = await User.find();\n    res.status(200).render(\"profile\");\n  } catch (e) {\n    res.status(500).json(e);\n  }\n});\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIkFjY2Vzc0NvbnRyb2wiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJnZXQiLCJyZXEiLCJyZXMiLCJyZW5kZXIiLCJwb3N0IiwiZGF0YSIsImJvZHkiLCJuZXdEYXRhIiwiY2xlYW5EYXRhIiwiY29uc29sZSIsImxvZyIsInZhbGlkYXRlIiwiY2hlY2tFbWFpbCIsImVtYWlsIiwic2VuZCIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJDcnlwdG9KUyIsIkFFUyIsImVuY3J5cHQiLCJwcm9jZXNzIiwiZW52IiwiUEFTU19TRUMiLCJ0b1N0cmluZyIsInVzZXIiLCJjcmVhdGUiLCJzdGF0dXMiLCJlcnIiLCJmaW5kT25lIiwianNvbiIsIm9yaWdpbmFsUGFzc3dvcmQiLCJkZWNyeXB0IiwiZW5jIiwiVXRmOCIsIm1lc3NhZ2UiLCJlIiwiYXV0aGVudGljYXRlIiwiYWMiLCJleHBvcnRzIiwicm9sZXMiLCJncmFudCIsInJlYWRPd24iLCJ1cGRhdGVPd24iLCJleHRlbmQiLCJyZWFkQW55IiwidXBkYXRlQW55IiwiZGVsZXRlQW55IiwidXNlcnMiLCJmaW5kIl0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyBjbGVhbkRhdGEsIHZhbGlkYXRlLCBjaGVja0VtYWlsIH0gZnJvbSAnLi4vdXRpbHMnO1xuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy9Vc2VyJylcbmltcG9ydCBDcnlwdG9KUyBmcm9tIFwiY3J5cHRvLWpzXCI7XG5jb25zdCBBY2Nlc3NDb250cm9sID0gcmVxdWlyZSgnYWNjZXNzY29udHJvbCcpO1xuXG5cblxuY29uc3Qgcm91dGVyID0gUm91dGVyKCk7XG5cbnJvdXRlci5nZXQoXCIvXCIsIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICAgIHJlcy5yZW5kZXIoJ2luZGV4Jyk7XG59KTtcblxucm91dGVyLmdldChcIi9yZWdpc3RlclwiLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICByZXMucmVuZGVyKCdyZWdpc3RlcicpO1xufSk7XG5cbnJvdXRlci5wb3N0KCcvcmVnaXN0ZXInLCBhc3luYyBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICBsZXQgZGF0YSA9IHJlcS5ib2R5O1xuICAgIGxldCBuZXdEYXRhID0gY2xlYW5EYXRhKGRhdGEpO1xuICAgIGNvbnNvbGUubG9nKG5ld0RhdGEpXG4gICAgaWYgKCF2YWxpZGF0ZShuZXdEYXRhKSB8fCAhY2hlY2tFbWFpbChuZXdEYXRhLmVtYWlsKSkge1xuICAgICAgICByZXMuc2VuZChcImRvbm7DqWUocykgaW5jb3JyZWN0ZShzKVwiKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vcGVyc2lzdCB1c2VyIGluIGRhdGFiYXNlXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgeyB1c2VybmFtZSwgZW1haWwsIHBhc3N3b3JkIH0gPSBuZXdEYXRhXG4gICAgICAgICAgICBwYXNzd29yZCA9IENyeXB0b0pTLkFFUy5lbmNyeXB0KHBhc3N3b3JkLCBwcm9jZXNzLmVudi5QQVNTX1NFQykudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmNyZWF0ZSh7IHVzZXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQgfSlcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAxKS5yZW5kZXIoJ2xvZ2luJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy9pZiBlcnJvciB0aGVuIHNlbmQgZXJyb3IgXG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIC8vY29uc3QgZXJyb3JzID0gc2lnblVwRXJyb3JzKGVycilcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKGVycilcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG4vL1Nob3dpbmcgbG9naW4gZm9ybVxucm91dGVyLmdldChcIi9sb2dpblwiLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICByZXMucmVuZGVyKCdsb2dpbicpO1xufSk7XG5cbnJvdXRlci5wb3N0KCcvbG9naW4nLCBhc3luYyBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICAvLzEtIGdldCBkYXRhIFxuICAgIGNvbnNvbGUubG9nKHJlcS5ib2R5KTtcbiAgICAvLzItIGF1dGhlbnRpY2F0ZSB1c2VyIFxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogcmVxLmJvZHkudXNlcm5hbWUgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKFwiVXRpbGlzYXRldXIgaW5jb25udSAhISFcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsUGFzc3dvcmQgPSBDcnlwdG9KUy5BRVMuZGVjcnlwdChcbiAgICAgICAgICAgICAgICB1c2VyLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIHByb2Nlc3MuZW52LlBBU1NfU0VDXG4gICAgICAgICAgICApLnRvU3RyaW5nKENyeXB0b0pTLmVuYy5VdGY4KTtcblxuICAgICAgICAgICAgb3JpZ2luYWxQYXNzd29yZCAhPT0gcmVxLmJvZHkucGFzc3dvcmQgPyByZXMuc3RhdHVzKDQwMSkuc2VuZCh7IG1lc3NhZ2U6IFwiTGUgbW90IGRlIHBhc3NlIG5lIGNvcnJlc3BvbmQgcGFzLlwiIH0pIDogcmVzLnJlbmRlcignaG9tZScpO1xuICAgICAgICB9XG5cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKGUpO1xuICAgIH1cblxuICAgIC8vMy0gaWYgc3VjY2VzcyByZWRpcmVjdCB0byBob21lIHBhZ2UgXG5cbn0pO1xuY29uc3QgYXV0aGVudGljYXRlID0gKCkgPT4ge1xuICAgIGNvbnN0IGFjID0gbmV3IEFjY2Vzc0NvbnRyb2woKTtcbiAgICBleHBvcnRzLnJvbGVzID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYWMuZ3JhbnQoXCJVc2VyXCIpLnJlYWRPd24oXCJwcm9maWxlXCIpLnVwZGF0ZU93bihcInByb2ZpbGVcIilcbiAgICAgICAgYWMuZ3JhbnQoXCJBZG1pblwiKS5leHRlbmQoXCJ1c2VyXCIpLnJlYWRBbnkoXCJwcm9maWxlXCIpIC51cGRhdGVBbnkoXCJwcm9maWxlXCIpIC5kZWxldGVBbnkoXCJwcm9maWxlXCIpXG4gICAgICAgIGNvbnNvbGUubG9nKGFjKVxuICAgICAgICAgICAgcmV0dXJuIGFjO1xuICAgIH0pXG5cbn1cblxucm91dGVyLmdldChcIi9hbGx1c2Vyc1wiLGF1dGhlbnRpY2F0ZSwgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgVXNlci5maW5kKClcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnJlbmRlcihcInByb2ZpbGVcIik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbihlKTtcbiAgICB9XG59KTtcblxuXG5cblxuXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG5cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUVBOzs7O0FBREEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBcEI7O0FBRUEsTUFBTUMsYUFBYSxHQUFHRCxPQUFPLENBQUMsZUFBRCxDQUE3Qjs7QUFJQSxNQUFNRSxNQUFNLEdBQUcsSUFBQUMsZUFBQSxHQUFmO0FBRUFELE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLEdBQVgsRUFBZ0IsVUFBVUMsR0FBVixFQUFlQyxHQUFmLEVBQW9CO0VBQ2hDQSxHQUFHLENBQUND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","map":{"version":3,"names":["User","require","AccessControl","router","Router","get","req","res","render","post","data","body","newData","cleanData","console","log","validate","checkEmail","email","send","username","password","CryptoJS","AES","encrypt","process","env","PASS_SEC","toString","user","create","status","err","findOne","json","originalPassword","decrypt","enc","Utf8","message","e","authenticate","ac","exports","roles","grant","readOwn","updateOwn","extend","readAny","updateAny","deleteAny","users","find"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/routes/","sources":["index.js"],"sourcesContent":["import { Router } from 'express';\nimport { cleanData, validate, checkEmail } from '../utils';\nconst User = require('../models/User')\nimport CryptoJS from \"crypto-js\";\nconst AccessControl = require('accesscontrol');\n\n\n\nconst router = Router();\n\nrouter.get(\"/\", function (req, res) {\n    res.render('index');\n});\n\nrouter.get(\"/register\", function (req, res) {\n    res.render('register');\n});\n\nrouter.post('/register', async function (req, res) {\n    let data = req.body;\n    let newData = cleanData(data);\n    console.log(newData)\n    if (!validate(newData) || !checkEmail(newData.email)) {\n        res.send(\"donnée(s) incorrecte(s)\");\n    }\n    else {\n        //persist user in database\n        try {\n            let { username, email, password } = newData\n            password = CryptoJS.AES.encrypt(password, process.env.PASS_SEC).toString();\n            const user = await User.create({ username, email, password })\n            res.status(201).render('login');\n        }\n        //if error then send error \n        catch (err) {\n            //const errors = signUpErrors(err)\n            res.status(200).send(err)\n        }\n    }\n});\n\n//Showing login form\nrouter.get(\"/login\", function (req, res) {\n    res.render('login');\n});\n\nrouter.post('/login', async function (req, res) {\n    //1- get data \n    console.log(req.body);\n    //2- authenticate user \n    try {\n        const user = await User.findOne({ username: req.body.username });\n        console.log(user);\n        if (!user) {\n            res.status(401).json(\"Utilisateur inconnu !!!\");\n        }\n        else {\n\n            const originalPassword = CryptoJS.AES.decrypt(\n                user.password,\n                process.env.PASS_SEC\n            ).toString(CryptoJS.enc.Utf8);\n\n            originalPassword !== req.body.password ? res.status(401).send({ message: \"Le mot de passe ne correspond pas.\" }) : res.render('home');\n        }\n\n    } catch (e) {\n        res.status(500).json(e);\n    }\n\n    //3- if success redirect to home page \n\n});\nconst authenticate = () => {\n    const ac = new AccessControl();\n    exports.roles = (function () {\n        ac.grant(\"User\").readOwn(\"profile\").updateOwn(\"profile\")\n        ac.grant(\"Admin\").extend(\"user\").readAny(\"profile\") .updateAny(\"profile\") .deleteAny(\"profile\")\n        console.log(ac)\n            return ac;\n    })\n\n}\n\nrouter.get(\"/allusers\",authenticate,  async (req, res) => {\n    try {\n        const users = await User.find()\n        res.status(200).render(\"profile\");\n    } catch (e) {\n        res.status(500).json(e);\n    }\n});\n\n\n\n\n\nexport default router;\n\n"],"mappings":"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"}},"mtime":1656165761806},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _routes = _interopRequireDefault(require(\"./routes\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst dotenv = require(\"dotenv\");\n\ndotenv.config();\n\nrequire('./database.js');\n\nvar app = (0, _express.default)();\n\nconst router = _express.default.Router();\n\napp.use(_express.default.json()); // Used to parse JSON bodies\n\napp.use(_express.default.urlencoded()); //Parse URL-encoded bodies\n\napp.set('view engine', 'ejs');\napp.use(_express.default.static(__dirname + '/../public')); //import routes\n\napp.use(_routes.default);\nvar port = process.env.PORT_SERVER || 9000;\napp.listen(port, function () {\n  console.log(\"Server Has Started! port: \", port);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkb3RlbnYiLCJyZXF1aXJlIiwiY29uZmlnIiwiYXBwIiwiZXhwcmVzcyIsInJvdXRlciIsIlJvdXRlciIsInVzZSIsImpzb24iLCJ1cmxlbmNvZGVkIiwic2V0Iiwic3RhdGljIiwiX19kaXJuYW1lIiwiRGVmYXVsdFJvdXRlciIsInBvcnQiLCJwcm9jZXNzIiwiZW52IiwiUE9SVF9TRVJWRVIiLCJsaXN0ZW4iLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvIiwic291cmNlcyI6WyJhcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIjtcbmNvbnN0IGRvdGVudiA9IHJlcXVpcmUoXCJkb3RlbnZcIik7XG5pbXBvcnQgRGVmYXVsdFJvdXRlciBmcm9tICcuL3JvdXRlcyc7XG5cblxuZG90ZW52LmNvbmZpZygpO1xuXG5yZXF1aXJlKCcuL2RhdGFiYXNlLmpzJylcblxudmFyIGFwcCA9IGV4cHJlc3MoKTtcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5cbmFwcC51c2UoZXhwcmVzcy5qc29uKCkpOyAvLyBVc2VkIHRvIHBhcnNlIEpTT04gYm9kaWVzXG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCgpKTsgLy9QYXJzZSBVUkwtZW5jb2RlZCBib2RpZXNcblxuYXBwLnNldCgndmlldyBlbmdpbmUnLCAnZWpzJyk7XG5cbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMoX19kaXJuYW1lICsgJy8uLi9wdWJsaWMnKSk7XG4vL2ltcG9ydCByb3V0ZXNcbmFwcC51c2UoRGVmYXVsdFJvdXRlcik7XG5cbnZhciBwb3J0ID0gcHJvY2Vzcy5lbnYuUE9SVF9TRVJWRVIgfHwgOTAwMDtcblxuYXBwLmxpc3Rlbihwb3J0LCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc29sZS5sb2coXCJTZXJ2ZXIgSGFzIFN0YXJ0ZWQhIHBvcnQ6IFwiLCBwb3J0KTtcbn0pO1xuXG4iXSwibWFwcGluZ3MiOiI7O0FBQUE7O0FBRUE7Ozs7QUFEQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxRQUFELENBQXRCOztBQUlBRCxNQUFNLENBQUNFLE1BQVA7O0FBRUFELE9BQU8sQ0FBQyxlQUFELENBQVA7O0FBRUEsSUFBSUUsR0FBRyxHQUFHLElBQUFDLGdCQUFBLEdBQVY7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxnQkFBQSxDQUFRRSxNQUFSLEVBQWY7O0FBRUFILEdBQUcsQ0FBQ0ksR0FBSixDQUFRSCxnQkFBQSxDQUFRSSxJQUFSLEVBQVIsRSxDQUF5Qjs7QUFDekJMLEdBQUcsQ0FBQ0ksR0FBSixDQUFRSCxnQkFBQSxDQUFRSyxVQUFSLEVBQVIsRSxDQUErQjs7QUFFL0JOLEdBQUcsQ0FBQ08sR0FBSixDQUFRLGFBQVIsRUFBdUIsS0FBdkI7QUFFQVAsR0FBRyxDQUFDSSxHQUFKLENBQVFILGdCQUFBLENBQVFPLE1BQVIsQ0FBZUMsU0FBUyxHQUFHLFlBQTNCLENBQVIsRSxDQUNBOztBQUNBVCxHQUFHLENBQUNJLEdBQUosQ0FBUU0sZUFBUjtBQUVBLElBQUlDLElBQUksR0FBR0MsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFdBQVosSUFBMkIsSUFBdEM7QUFFQWQsR0FBRyxDQUFDZSxNQUFKLENBQVdKLElBQVgsRUFBaUIsWUFBWTtFQUN6QkssT0FBTyxDQUFDQyxHQUFSLENBQVksNEJBQVosRUFBMENOLElBQTFDO0FBQ0gsQ0FGRCJ9","map":{"version":3,"names":["dotenv","require","config","app","express","router","Router","use","json","urlencoded","set","static","__dirname","DefaultRouter","port","process","env","PORT_SERVER","listen","console","log"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/","sources":["app.js"],"sourcesContent":["import express from \"express\";\nconst dotenv = require(\"dotenv\");\nimport DefaultRouter from './routes';\n\n\ndotenv.config();\n\nrequire('./database.js')\n\nvar app = express();\nconst router = express.Router();\n\napp.use(express.json()); // Used to parse JSON bodies\napp.use(express.urlencoded()); //Parse URL-encoded bodies\n\napp.set('view engine', 'ejs');\n\napp.use(express.static(__dirname + '/../public'));\n//import routes\napp.use(DefaultRouter);\n\nvar port = process.env.PORT_SERVER || 9000;\n\napp.listen(port, function () {\n    console.log(\"Server Has Started! port: \", port);\n});\n\n"],"mappings":";;AAAA;;AAEA;;;;AADA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AAIAD,MAAM,CAACE,MAAP;;AAEAD,OAAO,CAAC,eAAD,CAAP;;AAEA,IAAIE,GAAG,GAAG,IAAAC,gBAAA,GAAV;;AACA,MAAMC,MAAM,GAAGD,gBAAA,CAAQE,MAAR,EAAf;;AAEAH,GAAG,CAACI,GAAJ,CAAQH,gBAAA,CAAQI,IAAR,EAAR,E,CAAyB;;AACzBL,GAAG,CAACI,GAAJ,CAAQH,gBAAA,CAAQK,UAAR,EAAR,E,CAA+B;;AAE/BN,GAAG,CAACO,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;AAEAP,GAAG,CAACI,GAAJ,CAAQH,gBAAA,CAAQO,MAAR,CAAeC,SAAS,GAAG,YAA3B,CAAR,E,CACA;;AACAT,GAAG,CAACI,GAAJ,CAAQM,eAAR;AAEA,IAAIC,IAAI,GAAGC,OAAO,CAACC,GAAR,CAAYC,WAAZ,IAA2B,IAAtC;AAEAd,GAAG,CAACe,MAAJ,CAAWJ,IAAX,EAAiB,YAAY;EACzBK,OAAO,CAACC,GAAR,CAAY,4BAAZ,EAA0CN,IAA1C;AACH,CAFD"}},"mtime":1656162829145},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _express = require(\"express\");\n\nvar _utils = require(\"../utils\");\n\nvar _cryptoJs = _interopRequireDefault(require(\"crypto-js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst User = require('../models/User');\n\nconst AccessControl = require('accesscontrol');\n\nconst router = (0, _express.Router)();\nrouter.get(\"/\", function (req, res) {\n  res.render('index');\n});\nrouter.get(\"/register\", function (req, res) {\n  res.render('register');\n});\nrouter.post('/register', async function (req, res) {\n  let data = req.body;\n  let newData = (0, _utils.cleanData)(data);\n  console.log(newData);\n\n  if (!(0, _utils.validate)(newData) || !(0, _utils.checkEmail)(newData.email)) {\n    res.send(\"donnée(s) incorrecte(s)\");\n  } else {\n    //persist user in database\n    try {\n      let {\n        username,\n        email,\n        password\n      } = newData;\n      password = _cryptoJs.default.AES.encrypt(password, process.env.PASS_SEC).toString();\n      const user = await User.create({\n        username,\n        email,\n        password\n      });\n      res.status(201).render('login');\n    } //if error then send error \n    catch (err) {\n      //const errors = signUpErrors(err)\n      res.status(200).send(err);\n    }\n  }\n}); //Showing login form\n\nrouter.get(\"/login\", function (req, res) {\n  res.render('login');\n});\nrouter.post('/login', async function (req, res) {\n  //1- get data \n  console.log(req.body); //2- authenticate user \n\n  try {\n    const user = await User.findOne({\n      username: req.body.username\n    });\n    console.log(user);\n\n    if (!user) {\n      res.status(401).json(\"Utilisateur inconnu !!!\");\n    } else {\n      const originalPassword = _cryptoJs.default.AES.decrypt(user.password, process.env.PASS_SEC).toString(_cryptoJs.default.enc.Utf8);\n\n      originalPassword !== req.body.password ? res.status(401).send({\n        message: \"Le mot de passe ne correspond pas.\"\n      }) : res.render('home');\n    }\n  } catch (e) {\n    res.status(500).json(e);\n  } //3- if success redirect to home page \n\n});\n\nconst authenticate = () => {\n  const ac = new AccessControl();\n\n  exports.roles = function () {\n    ac.grant(\"User\").readOwn(\"profile\").updateOwn(\"profile\");\n    ac.grant(\"Admin\").extend(\"user\").readAny(\"profile\").updateAny(\"profile\").deleteAny(\"profile\");\n    console.log(ac);\n    return ac;\n  };\n};\n\nrouter.get(\"/allusers\", authenticate, async (req, res) => {\n  try {\n    const users = await User.find();\n    res.status(200).render(\"profile\");\n  } catch (e) {\n    res.status(500).json(e);\n  }\n});\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIkFjY2Vzc0NvbnRyb2wiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJnZXQiLCJyZXEiLCJyZXMiLCJyZW5kZXIiLCJwb3N0IiwiZGF0YSIsImJvZHkiLCJuZXdEYXRhIiwiY2xlYW5EYXRhIiwiY29uc29sZSIsImxvZyIsInZhbGlkYXRlIiwiY2hlY2tFbWFpbCIsImVtYWlsIiwic2VuZCIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJDcnlwdG9KUyIsIkFFUyIsImVuY3J5cHQiLCJwcm9jZXNzIiwiZW52IiwiUEFTU19TRUMiLCJ0b1N0cmluZyIsInVzZXIiLCJjcmVhdGUiLCJzdGF0dXMiLCJlcnIiLCJmaW5kT25lIiwianNvbiIsIm9yaWdpbmFsUGFzc3dvcmQiLCJkZWNyeXB0IiwiZW5jIiwiVXRmOCIsIm1lc3NhZ2UiLCJlIiwiYXV0aGVudGljYXRlIiwiYWMiLCJleHBvcnRzIiwicm9sZXMiLCJncmFudCIsInJlYWRPd24iLCJ1cGRhdGVPd24iLCJleHRlbmQiLCJyZWFkQW55IiwidXBkYXRlQW55IiwiZGVsZXRlQW55IiwidXNlcnMiLCJmaW5kIl0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyBjbGVhbkRhdGEsIHZhbGlkYXRlLCBjaGVja0VtYWlsIH0gZnJvbSAnLi4vdXRpbHMnO1xuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy9Vc2VyJylcbmltcG9ydCBDcnlwdG9KUyBmcm9tIFwiY3J5cHRvLWpzXCI7XG5jb25zdCBBY2Nlc3NDb250cm9sID0gcmVxdWlyZSgnYWNjZXNzY29udHJvbCcpO1xuXG5cblxuY29uc3Qgcm91dGVyID0gUm91dGVyKCk7XG5cbnJvdXRlci5nZXQoXCIvXCIsIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICAgIHJlcy5yZW5kZXIoJ2luZGV4Jyk7XG59KTtcblxucm91dGVyLmdldChcIi9yZWdpc3RlclwiLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICByZXMucmVuZGVyKCdyZWdpc3RlcicpO1xufSk7XG5cbnJvdXRlci5wb3N0KCcvcmVnaXN0ZXInLCBhc3luYyBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICBsZXQgZGF0YSA9IHJlcS5ib2R5O1xuICAgIGxldCBuZXdEYXRhID0gY2xlYW5EYXRhKGRhdGEpO1xuICAgIGNvbnNvbGUubG9nKG5ld0RhdGEpXG4gICAgaWYgKCF2YWxpZGF0ZShuZXdEYXRhKSB8fCAhY2hlY2tFbWFpbChuZXdEYXRhLmVtYWlsKSkge1xuICAgICAgICByZXMuc2VuZChcImRvbm7DqWUocykgaW5jb3JyZWN0ZShzKVwiKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vcGVyc2lzdCB1c2VyIGluIGRhdGFiYXNlXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgeyB1c2VybmFtZSwgZW1haWwsIHBhc3N3b3JkIH0gPSBuZXdEYXRhXG4gICAgICAgICAgICBwYXNzd29yZCA9IENyeXB0b0pTLkFFUy5lbmNyeXB0KHBhc3N3b3JkLCBwcm9jZXNzLmVudi5QQVNTX1NFQykudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmNyZWF0ZSh7IHVzZXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQgfSlcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAxKS5yZW5kZXIoJ2xvZ2luJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy9pZiBlcnJvciB0aGVuIHNlbmQgZXJyb3IgXG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIC8vY29uc3QgZXJyb3JzID0gc2lnblVwRXJyb3JzKGVycilcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKGVycilcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG4vL1Nob3dpbmcgbG9naW4gZm9ybVxucm91dGVyLmdldChcIi9sb2dpblwiLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICByZXMucmVuZGVyKCdsb2dpbicpO1xufSk7XG5cbnJvdXRlci5wb3N0KCcvbG9naW4nLCBhc3luYyBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICAvLzEtIGdldCBkYXRhIFxuICAgIGNvbnNvbGUubG9nKHJlcS5ib2R5KTtcbiAgICAvLzItIGF1dGhlbnRpY2F0ZSB1c2VyIFxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogcmVxLmJvZHkudXNlcm5hbWUgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKFwiVXRpbGlzYXRldXIgaW5jb25udSAhISFcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsUGFzc3dvcmQgPSBDcnlwdG9KUy5BRVMuZGVjcnlwdChcbiAgICAgICAgICAgICAgICB1c2VyLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIHByb2Nlc3MuZW52LlBBU1NfU0VDXG4gICAgICAgICAgICApLnRvU3RyaW5nKENyeXB0b0pTLmVuYy5VdGY4KTtcblxuICAgICAgICAgICAgb3JpZ2luYWxQYXNzd29yZCAhPT0gcmVxLmJvZHkucGFzc3dvcmQgPyByZXMuc3RhdHVzKDQwMSkuc2VuZCh7IG1lc3NhZ2U6IFwiTGUgbW90IGRlIHBhc3NlIG5lIGNvcnJlc3BvbmQgcGFzLlwiIH0pIDogcmVzLnJlbmRlcignaG9tZScpO1xuICAgICAgICB9XG5cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKGUpO1xuICAgIH1cblxuICAgIC8vMy0gaWYgc3VjY2VzcyByZWRpcmVjdCB0byBob21lIHBhZ2UgXG5cbn0pO1xuY29uc3QgYXV0aGVudGljYXRlID0gKCkgPT4ge1xuICAgIGNvbnN0IGFjID0gbmV3IEFjY2Vzc0NvbnRyb2woKTtcbiAgICBleHBvcnRzLnJvbGVzID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYWMuZ3JhbnQoXCJVc2VyXCIpLnJlYWRPd24oXCJwcm9maWxlXCIpLnVwZGF0ZU93bihcInByb2ZpbGVcIilcbiAgICAgICAgYWMuZ3JhbnQoXCJBZG1pblwiKS5leHRlbmQoXCJ1c2VyXCIpLnJlYWRBbnkoXCJwcm9maWxlXCIpIC51cGRhdGVBbnkoXCJwcm9maWxlXCIpIC5kZWxldGVBbnkoXCJwcm9maWxlXCIpXG4gICAgICAgIGNvbnNvbGUubG9nKGFjKVxuICAgICAgICAgICAgcmV0dXJuIGFjO1xuICAgIH0pXG5cbn1cblxucm91dGVyLmdldChcIi9hbGx1c2Vyc1wiLGF1dGhlbnRpY2F0ZSwgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgVXNlci5maW5kKClcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnJlbmRlcihcInByb2ZpbGVcIik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbihlKTtcbiAgICB9XG59KTtcblxuXG5cblxuXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG5cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUVBOzs7O0FBREEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBcEI7O0FBRUEsTUFBTUMsYUFBYSxHQUFHRCxPQUFPLENBQUMsZUFBRCxDQUE3Qjs7QUFJQSxNQUFNRSxNQUFNLEdBQUcsSUFBQUMsZUFBQSxHQUFmO0FBRUFELE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLEdBQVgsRUFBZ0IsVUFBVUMsR0FBVixFQUFlQyxHQUFmLEVBQW9CO0VBQ2hDQSxHQUFHLENBQUND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","map":{"version":3,"names":["User","require","AccessControl","router","Router","get","req","res","render","post","data","body","newData","cleanData","console","log","validate","checkEmail","email","send","username","password","CryptoJS","AES","encrypt","process","env","PASS_SEC","toString","user","create","status","err","findOne","json","originalPassword","decrypt","enc","Utf8","message","e","authenticate","ac","exports","roles","grant","readOwn","updateOwn","extend","readAny","updateAny","deleteAny","users","find"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/routes/","sources":["index.js"],"sourcesContent":["import { Router } from 'express';\nimport { cleanData, validate, checkEmail } from '../utils';\nconst User = require('../models/User')\nimport CryptoJS from \"crypto-js\";\nconst AccessControl = require('accesscontrol');\n\n\n\nconst router = Router();\n\nrouter.get(\"/\", function (req, res) {\n    res.render('index');\n});\n\nrouter.get(\"/register\", function (req, res) {\n    res.render('register');\n});\n\nrouter.post('/register', async function (req, res) {\n    let data = req.body;\n    let newData = cleanData(data);\n    console.log(newData)\n    if (!validate(newData) || !checkEmail(newData.email)) {\n        res.send(\"donnée(s) incorrecte(s)\");\n    }\n    else {\n        //persist user in database\n        try {\n            let { username, email, password } = newData\n            password = CryptoJS.AES.encrypt(password, process.env.PASS_SEC).toString();\n            const user = await User.create({ username, email, password })\n            res.status(201).render('login');\n        }\n        //if error then send error \n        catch (err) {\n            //const errors = signUpErrors(err)\n            res.status(200).send(err)\n        }\n    }\n});\n\n//Showing login form\nrouter.get(\"/login\", function (req, res) {\n    res.render('login');\n});\n\nrouter.post('/login', async function (req, res) {\n    //1- get data \n    console.log(req.body);\n    //2- authenticate user \n    try {\n        const user = await User.findOne({ username: req.body.username });\n        console.log(user);\n        if (!user) {\n            res.status(401).json(\"Utilisateur inconnu !!!\");\n        }\n        else {\n\n            const originalPassword = CryptoJS.AES.decrypt(\n                user.password,\n                process.env.PASS_SEC\n            ).toString(CryptoJS.enc.Utf8);\n\n            originalPassword !== req.body.password ? res.status(401).send({ message: \"Le mot de passe ne correspond pas.\" }) : res.render('home');\n        }\n\n    } catch (e) {\n        res.status(500).json(e);\n    }\n\n    //3- if success redirect to home page \n\n});\nconst authenticate = () => {\n    const ac = new AccessControl();\n    exports.roles = (function () {\n        ac.grant(\"User\").readOwn(\"profile\").updateOwn(\"profile\")\n        ac.grant(\"Admin\").extend(\"user\").readAny(\"profile\") .updateAny(\"profile\") .deleteAny(\"profile\")\n        console.log(ac)\n            return ac;\n    })\n\n}\n\nrouter.get(\"/allusers\",authenticate,  async (req, res) => {\n    try {\n        const users = await User.find()\n        res.status(200).render(\"profile\");\n    } catch (e) {\n        res.status(500).json(e);\n    }\n});\n\n\n\n\n\nexport default router;\n\n"],"mappings":"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"}},"mtime":1656165761806},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/utils.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkEmail = checkEmail;\nexports.cleanData = cleanData;\nexports.validate = validate;\n\nfunction cleanData(data) {\n  data.username = data.username.replace(/(<([^>]+)>)/ig, '');\n  return data;\n}\n\nfunction validate(data) {\n  var str = data.password;\n  var str2 = data.passwordConfirm;\n\n  if (str != str2) {\n    return false;\n  }\n\n  if (str.match(/[0-9]/g) && str.match(/[A-Z]/g) && str.match(/[a-z]/g) && str.match(/[^a-zA-Z\\d]/g) && str.length >= 12) {\n    return true;\n  } else {\n    console.log(\"validate false\");\n    return false;\n  }\n}\n\nfunction checkEmail(data) {\n  var mailformat = /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/;\n\n  if (data.match(mailformat)) {\n    return true;\n  } else {\n    alert(\"Vous avez saisi une adresse électronique non valide !\");\n    return false;\n  }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjbGVhbkRhdGEiLCJkYXRhIiwidXNlcm5hbWUiLCJyZXBsYWNlIiwidmFsaWRhdGUiLCJzdHIiLCJwYXNzd29yZCIsInN0cjIiLCJwYXNzd29yZENvbmZpcm0iLCJtYXRjaCIsImxlbmd0aCIsImNvbnNvbGUiLCJsb2ciLCJjaGVja0VtYWlsIiwibWFpbGZvcm1hdCIsImFsZXJ0Il0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvIiwic291cmNlcyI6WyJ1dGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gY2xlYW5EYXRhKGRhdGEpIHtcbiAgICBkYXRhLnVzZXJuYW1lID0gZGF0YS51c2VybmFtZS5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJycpO1xuICAgIHJldHVybiBkYXRhO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUoZGF0YSkge1xuICAgIHZhciBzdHIgPSBkYXRhLnBhc3N3b3JkO1xuICAgIHZhciBzdHIyID0gZGF0YS5wYXNzd29yZENvbmZpcm07XG4gICAgaWYgKHN0ciAhPSBzdHIyKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIGlmIChzdHIubWF0Y2goL1swLTldL2cpICYmXG4gICAgICAgIHN0ci5tYXRjaCgvW0EtWl0vZykgJiZcbiAgICAgICAgc3RyLm1hdGNoKC9bYS16XS9nKSAmJlxuICAgICAgICBzdHIubWF0Y2goL1teYS16QS1aXFxkXS9nKSAmJlxuICAgICAgICBzdHIubGVuZ3RoID49IDEyKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ2YWxpZGF0ZSBmYWxzZVwiKVxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja0VtYWlsKGRhdGEpIHtcbiAgICB2YXIgbWFpbGZvcm1hdCA9IC9eXFx3KyhbXFwuLV0/XFx3KykqQFxcdysoW1xcLi1dP1xcdyspKihcXC5cXHd7MiwzfSkrJC87XG4gICAgaWYgKGRhdGEubWF0Y2gobWFpbGZvcm1hdCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhbGVydChcIlZvdXMgYXZleiBzYWlzaSB1bmUgYWRyZXNzZSDDqWxlY3Ryb25pcXVlIG5vbiB2YWxpZGUgIVwiKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFPLFNBQVNBLFNBQVQsQ0FBbUJDLElBQW5CLEVBQXlCO0VBQzVCQSxJQUFJLENBQUNDLFFBQUwsR0FBZ0JELElBQUksQ0FBQ0MsUUFBTCxDQUFjQyxPQUFkLENBQXNCLGVBQXRCLEVBQXVDLEVBQXZDLENBQWhCO0VBQ0EsT0FBT0YsSUFBUDtBQUNIOztBQUVNLFNBQVNHLFFBQVQsQ0FBa0JILElBQWxCLEVBQXdCO0VBQzNCLElBQUlJLEdBQUcsR0FBR0osSUFBSSxDQUFDSyxRQUFmO0VBQ0EsSUFBSUMsSUFBSSxHQUFHTixJQUFJLENBQUNPLGVBQWhCOztFQUNBLElBQUlILEdBQUcsSUFBSUUsSUFBWCxFQUFpQjtJQUNiLE9BQU8sS0FBUDtFQUNIOztFQUVELElBQUlGLEdBQUcsQ0FBQ0ksS0FBSixDQUFVLFFBQVYsS0FDQUosR0FBRyxDQUFDSSxLQUFKLENBQVUsUUFBVixDQURBLElBRUFKLEdBQUcsQ0FBQ0ksS0FBSixDQUFVLFFBQVYsQ0FGQSxJQUdBSixHQUFHLENBQUNJLEtBQUosQ0FBVSxjQUFWLENBSEEsSUFJQUosR0FBRyxDQUFDSyxNQUFKLElBQWMsRUFKbEIsRUFJc0I7SUFDbEIsT0FBTyxJQUFQO0VBQ0gsQ0FORCxNQU9LO0lBQ0RDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdCQUFaO0lBQ0EsT0FBTyxLQUFQO0VBQ0g7QUFDSjs7QUFFTSxTQUFTQyxVQUFULENBQW9CWixJQUFwQixFQUEwQjtFQUM3QixJQUFJYSxVQUFVLEdBQUcsK0NBQWpCOztFQUNBLElBQUliLElBQUksQ0FBQ1EsS0FBTCxDQUFXSyxVQUFYLENBQUosRUFBNEI7SUFDeEIsT0FBTyxJQUFQO0VBQ0gsQ0FGRCxNQUdLO0lBQ0RDLEtBQUssQ0FBQyx1REFBRCxDQUFMO0lBQ0EsT0FBTyxLQUFQO0VBQ0g7QUFDSiJ9","map":{"version":3,"names":["cleanData","data","username","replace","validate","str","password","str2","passwordConfirm","match","length","console","log","checkEmail","mailformat","alert"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/","sources":["utils.js"],"sourcesContent":["export function cleanData(data) {\n    data.username = data.username.replace(/(<([^>]+)>)/ig, '');\n    return data;\n}\n\nexport function validate(data) {\n    var str = data.password;\n    var str2 = data.passwordConfirm;\n    if (str != str2) {\n        return false\n    }\n\n    if (str.match(/[0-9]/g) &&\n        str.match(/[A-Z]/g) &&\n        str.match(/[a-z]/g) &&\n        str.match(/[^a-zA-Z\\d]/g) &&\n        str.length >= 12) {\n        return true;\n    }\n    else {\n        console.log(\"validate false\")\n        return false\n    }\n}\n\nexport function checkEmail(data) {\n    var mailformat = /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/;\n    if (data.match(mailformat)) {\n        return true;\n    }\n    else {\n        alert(\"Vous avez saisi une adresse électronique non valide !\");\n        return false;\n    }\n}"],"mappings":";;;;;;;;;AAAO,SAASA,SAAT,CAAmBC,IAAnB,EAAyB;EAC5BA,IAAI,CAACC,QAAL,GAAgBD,IAAI,CAACC,QAAL,CAAcC,OAAd,CAAsB,eAAtB,EAAuC,EAAvC,CAAhB;EACA,OAAOF,IAAP;AACH;;AAEM,SAASG,QAAT,CAAkBH,IAAlB,EAAwB;EAC3B,IAAII,GAAG,GAAGJ,IAAI,CAACK,QAAf;EACA,IAAIC,IAAI,GAAGN,IAAI,CAACO,eAAhB;;EACA,IAAIH,GAAG,IAAIE,IAAX,EAAiB;IACb,OAAO,KAAP;EACH;;EAED,IAAIF,GAAG,CAACI,KAAJ,CAAU,QAAV,KACAJ,GAAG,CAACI,KAAJ,CAAU,QAAV,CADA,IAEAJ,GAAG,CAACI,KAAJ,CAAU,QAAV,CAFA,IAGAJ,GAAG,CAACI,KAAJ,CAAU,cAAV,CAHA,IAIAJ,GAAG,CAACK,MAAJ,IAAc,EAJlB,EAIsB;IAClB,OAAO,IAAP;EACH,CAND,MAOK;IACDC,OAAO,CAACC,GAAR,CAAY,gBAAZ;IACA,OAAO,KAAP;EACH;AACJ;;AAEM,SAASC,UAAT,CAAoBZ,IAApB,EAA0B;EAC7B,IAAIa,UAAU,GAAG,+CAAjB;;EACA,IAAIb,IAAI,CAACQ,KAAL,CAAWK,UAAX,CAAJ,EAA4B;IACxB,OAAO,IAAP;EACH,CAFD,MAGK;IACDC,KAAK,CAAC,uDAAD,CAAL;IACA,OAAO,KAAP;EACH;AACJ"}},"mtime":1656157851980},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/models/User.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require(\"mongoose\");\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  username: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  Role: {\n    type: String,\n    default: 'User',\n    required: true\n  }\n}, {\n  timestamps: true\n});\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJTY2hlbWEiLCJVc2VyU2NoZW1hIiwidXNlcm5hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJlbWFpbCIsInVuaXF1ZSIsInBhc3N3b3JkIiwiUm9sZSIsImRlZmF1bHQiLCJ0aW1lc3RhbXBzIiwiVXNlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL0FwcGxpY2F0aW9ucy9kb3NzaWVyL2N5YmVyU2XMgWN1cml0ZcyBL3NpbXBsZWF1dGgvc3JjL21vZGVscy8iLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XG5cbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYTtcbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXNlcm5hbWU6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgIGVtYWlsOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LFxuICAgIHBhc3N3b3JkOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICBSb2xlOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJ1VzZXInLCByZXF1aXJlZDogdHJ1ZSB9LFxuICB9LFxuICB7XG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgfVxuKTtcblxubGV0IFVzZXIgPSBtb25nb29zZS5tb2RlbCgnVXNlcicsIFVzZXJTY2hlbWEpO1xubW9kdWxlLmV4cG9ydHMgPSBVc2VyO1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBRUEsTUFBTUMsTUFBTSxHQUFHRixRQUFRLENBQUNFLE1BQXhCO0FBQ0EsTUFBTUMsVUFBVSxHQUFHLElBQUlELE1BQUosQ0FDakI7RUFDRUUsUUFBUSxFQUFFO0lBQUVDLElBQUksRUFBRUMsTUFBUjtJQUFnQkMsUUFBUSxFQUFFO0VBQTFCLENBRFo7RUFFRUMsS0FBSyxFQUFFO0lBQUVILElBQUksRUFBRUMsTUFBUjtJQUFnQkMsUUFBUSxFQUFFLElBQTFCO0lBQWdDRSxNQUFNLEVBQUU7RUFBeEMsQ0FGVDtFQUdFQyxRQUFRLEVBQUU7SUFBRUwsSUFBSSxFQUFFQyxNQUFSO0lBQWdCQyxRQUFRLEVBQUU7RUFBMUIsQ0FIWjtFQUlFSSxJQUFJLEVBQUU7SUFBRU4sSUFBSSxFQUFFQyxNQUFSO0lBQWdCTSxPQUFPLEVBQUUsTUFBekI7SUFBaUNMLFFBQVEsRUFBRTtFQUEzQztBQUpSLENBRGlCLEVBT2pCO0VBQ0VNLFVBQVUsRUFBRTtBQURkLENBUGlCLENBQW5CO0FBWUEsSUFBSUMsSUFBSSxHQUFHZCxRQUFRLENBQUNlLEtBQVQsQ0FBZSxNQUFmLEVBQXVCWixVQUF2QixDQUFYO0FBQ0FhLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsSUFBakIifQ==","map":{"version":3,"names":["mongoose","require","Schema","UserSchema","username","type","String","required","email","unique","password","Role","default","timestamps","User","model","module","exports"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/models/","sources":["User.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema(\n  {\n    username: { type: String, required: true },\n    email: { type: String, required: true, unique: true },\n    password: { type: String, required: true },\n    Role: { type: String, default: 'User', required: true },\n  },\n  {\n    timestamps: true,\n  }\n);\n\nlet User = mongoose.model('User', UserSchema);\nmodule.exports = User;\n"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CACjB;EACEE,QAAQ,EAAE;IAAEC,IAAI,EAAEC,MAAR;IAAgBC,QAAQ,EAAE;EAA1B,CADZ;EAEEC,KAAK,EAAE;IAAEH,IAAI,EAAEC,MAAR;IAAgBC,QAAQ,EAAE,IAA1B;IAAgCE,MAAM,EAAE;EAAxC,CAFT;EAGEC,QAAQ,EAAE;IAAEL,IAAI,EAAEC,MAAR;IAAgBC,QAAQ,EAAE;EAA1B,CAHZ;EAIEI,IAAI,EAAE;IAAEN,IAAI,EAAEC,MAAR;IAAgBM,OAAO,EAAE,MAAzB;IAAiCL,QAAQ,EAAE;EAA3C;AAJR,CADiB,EAOjB;EACEM,UAAU,EAAE;AADd,CAPiB,CAAnB;AAYA,IAAIC,IAAI,GAAGd,QAAQ,CAACe,KAAT,CAAe,MAAf,EAAuBZ,UAAvB,CAAX;AACAa,MAAM,CAACC,OAAP,GAAiBH,IAAjB"}},"mtime":1656163713977},"{\"assumptions\":{},\"sourceRoot\":\"/Applications/dossier/cyberSécurité/simpleauth/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"filename\":\"/Applications/dossier/cyberSécurité/simpleauth/src/database.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Applications/dossier/cyberSécurité/simpleauth\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.18.5:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require('mongoose');\n\nmongoose.connect(`mongodb+srv://EliotAlderson:TestBH-91@cluster0.gbvxg.mongodb.net/cyberProject`).then(() => console.log('Connected to MongoDB')).catch(error => console.log(\"Failed to connect MongoDB\", error));\n/* mongoose\n  .connect( \"mongodb://localhost:27017/cyberProject\")\n  .then(() => console.log(\"Db Connection Successfull!\"))\n  .catch((e) => {\n    console.log(e);\n  });\n */\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJjb25uZWN0IiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIvQXBwbGljYXRpb25zL2Rvc3NpZXIvY3liZXJTZcyBY3VyaXRlzIEvc2ltcGxlYXV0aC9zcmMvIiwic291cmNlcyI6WyJkYXRhYmFzZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJylcblxubW9uZ29vc2VcbiAgICAuY29ubmVjdChgbW9uZ29kYitzcnY6Ly9FbGlvdEFsZGVyc29uOlRlc3RCSC05MUBjbHVzdGVyMC5nYnZ4Zy5tb25nb2RiLm5ldC9jeWJlclByb2plY3RgKVxuICAgIC50aGVuKCgpID0+IGNvbnNvbGUubG9nKCdDb25uZWN0ZWQgdG8gTW9uZ29EQicpKVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGNvbm5lY3QgTW9uZ29EQlwiLCBlcnJvcikpXG5cblxuLyogbW9uZ29vc2VcbiAgLmNvbm5lY3QoIFwibW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9jeWJlclByb2plY3RcIilcbiAgLnRoZW4oKCkgPT4gY29uc29sZS5sb2coXCJEYiBDb25uZWN0aW9uIFN1Y2Nlc3NmdWxsIVwiKSlcbiAgLmNhdGNoKChlKSA9PiB7XG4gICAgY29uc29sZS5sb2coZSk7XG4gIH0pO1xuICovXG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUF4Qjs7QUFFQUQsUUFBUSxDQUNIRSxPQURMLENBQ2MsK0VBRGQsRUFFS0MsSUFGTCxDQUVVLE1BQU1DLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHNCQUFaLENBRmhCLEVBR0tDLEtBSEwsQ0FHWUMsS0FBRCxJQUFXSCxPQUFPLENBQUNDLEdBQVIsQ0FBWSwyQkFBWixFQUF5Q0UsS0FBekMsQ0FIdEI7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSJ9","map":{"version":3,"names":["mongoose","require","connect","then","console","log","catch","error"],"sourceRoot":"/Applications/dossier/cyberSécurité/simpleauth/src/","sources":["database.js"],"sourcesContent":["const mongoose = require('mongoose')\n\nmongoose\n    .connect(`mongodb+srv://EliotAlderson:TestBH-91@cluster0.gbvxg.mongodb.net/cyberProject`)\n    .then(() => console.log('Connected to MongoDB'))\n    .catch((error) => console.log(\"Failed to connect MongoDB\", error))\n\n\n/* mongoose\n  .connect( \"mongodb://localhost:27017/cyberProject\")\n  .then(() => console.log(\"Db Connection Successfull!\"))\n  .catch((e) => {\n    console.log(e);\n  });\n */\n"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CACHE,OADL,CACc,+EADd,EAEKC,IAFL,CAEU,MAAMC,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAFhB,EAGKC,KAHL,CAGYC,KAAD,IAAWH,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCE,KAAzC,CAHtB;AAMA;AACA;AACA;AACA;AACA;AACA;AACA"}},"mtime":1656158577736}}